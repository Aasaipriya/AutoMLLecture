\begin{tikzpicture}[node distance=2.1cm]
        			%PreProcessing
        			
        			\node (Agent) [activity] {Policy $\policy$};
        			
        			\node (Algo) [activity, right of=Agent, xshift=3cm] {Algorithm};
        			
        			\begin{pgfonlayer}{background}
        			\path (Agent -| Agent.west)+(-0.12,1.125) node (resUL) {};
        			\path (Algo.east |- Algo.south)+(0.125,-1.125) node (resBR) {};
        			
        			% Context
        			\path [rounded corners, draw=black!50, fill=white] ($(resUL)+(0.5, -0.5)$) rectangle ($(resBR)+(0.5, -0.5)$);
        			\path [rounded corners, draw=black!50, fill=white] ($(resUL)+(0.375, -0.375)$) rectangle ($(resBR)+(0.375, -0.375)$);
        			\path [rounded corners, draw=black!50, fill=white] ($(resUL)+(0.25, -0.25)$) rectangle ($(resBR)+(0.25, -0.25)$);
        			\path [rounded corners, draw=black!50, fill=white] ($(resUL)+(0.125, -0.125)$) rectangle ($(resBR)+(0.125, -0.125)$);
        			
        			% Top level
        			\path [rounded corners, draw=black!50, fill=white] (resUL) rectangle (resBR);
        			\path (resBR)+(-1.3,0.175) node [text=black!75] {instance $\inst \in \insts$};
        			\path (resUL.east |- resBR.north)+(+.9,0.075) node [text=black!75] {control of $h$};
        			
        			\end{pgfonlayer}
        			
        			%        \draw[myarrow] (feat.south) -- ($(feat.south |- Agent)+(0,1.125)$);
        			
        			\draw[myarrow] (Agent.north) -- ($(Agent.north)+(0.0,+0.35)$) -- ($(Algo.north)+(0.0,+0.35)$) node [above,pos=0.5] {apply action $a_t$} node [below,pos=0.5] {$\lambda_h = v$} -- (Algo.north);
        			\draw[myarrow, dashed] ($(Algo.south)+(-0.25, 0)$) -- ($(Algo.south)+(-0.25, -0.35)$) -- ($(Agent.south)+(0.25, -0.35)$) node [above,pos=0.5] {state $s_{t+1}$} -- ($(Agent.south)+(0.25, 0)$);
        			\draw[myarrow] ($(Algo.south)+(0.25, 0)$) -- ($(Algo.south)+(0.25, -0.55)$) -- ($(Agent.south)+(-0.25, -0.55)$) node [below,pos=0.5] {reward $r_{t+1}$} -- ($(Agent.south)+(-0.25, 0)$);
        			
        			\draw[<->, thick, draw=black!32.5] (resBR.east |- resUL.center) -- ($(resBR.east |- resUL.center)+(0.5, -0.5)$);
        			\path (resBR.east |- resUL.center)+(.5, -0.175) node [text=black!32.5] {$\insts$};
        			% This path is only needed so the figure stays centered (the text is not visible)
        			\path (resUL.west |- resUL.center)+(-.5, -0.175) node [text=black!0] {$\insts$}; 
        			
        			\end{tikzpicture}